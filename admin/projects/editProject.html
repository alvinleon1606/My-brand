<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>np-leonx | Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&display=swap" rel="stylesheet">
    <!-- css -->
    <link rel="stylesheet" href="../global.module.css">
    <link rel="stylesheet" href="./editProject.css">
    <!-- icons -->
    <script src="https://kit.fontawesome.com/86a1656fba.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <div class="side-nav">
            <nav>
                <div class="header-body-nav">
                    <div class="nav-header">
                        <h1>LeonX</h1>
                    </div>
                    <div class="nav-menu">
                        <a href="../Home.html">
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-brands fa-windows"></i></div>
                                <span>Dashboard</span>
                            </div>
                        </a>
                        <a href="../Blogs.html">
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-regular fa-newspaper"></i></div>
                                <span>Blogs</span>
                            </div>
                        </a>
                        <a href="../skills/Skills.html">
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-solid fa-code"></i></div>
                                <span>Skills</span>
                            </div>
                        </a>
                        <a href="../projects/Projects.html">
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-brands fa-app-store-ios"></i></div>
                                <span>Projects</span>
                            </div>
                        </a>
                        <a href="../services/services.html">
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-brands fa-servicestack"></i></div>
                                <span>Services</span>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="nav-footer">
                    <div class="nav-footer-menu">
                        <div class="each-menu">
                            <div class="menu-icon"><i class="fa-solid fa-gear"></i></div>
                            <span>Settings</span>
                        </div>
                        <div class="each-menu">
                            <div class="menu-icon"><i class="fa-solid fa-right-from-bracket"></i></div>
                            <span>Logout</span>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
        <main class="main">
            <div class="top-nav">
                <div class="toggle-icon"><i class="fa-solid fa-bars"></i></div>
                <div class="profile-pic">
                    <p class="profile-name">NL</p>
                </div>
            </div>
            <div class="body">
                <div class="body-hero-part">
                    <h1>Edit a Project</h1>
                    <div class="hero-nav">
                        <p class="menu">Home</p>
                        <i class="fa-solid fa-grip-lines-vertical"></i>
                        <p>Edit Project</p>
                    </div>
                </div>
                <div class="new-project-form">
                    <div class="project-header-menu">
                        <a href="./Projects.html">
                            <button>Projects List</button>
                        </a>
                    </div>
                    <form id="edit-project-form">
                        <div class="inputs">
                            <input type="text" id="edit-project-title" placeholder="Project title ...">
                            <select name="category" id="edit-project-category">
                                <option value="">Select Category</option>
                                <option value="Web">Web</option>
                                <option value="Mobile">Mobile</option>
                                <option value="Ui">UI/UX</option>
                            </select>
                        </div>
                        <div class="inputs">
                            <input type="text" id="edit-project-link" placeholder="Link ...">
                            <input type="date" id="project-finished-date">
                        </div>
                        <div class="inputs">
                            <input type="file" id="edit-project-image" required>
                        </div>
                        <div class="text-area">
                            <textarea id="edit-project-description" placeholder="Description ..." cols="30" rows="14"></textarea>
                        </div>
                        <button type="submit">Edit</button>
                    </form>
                </div>
            </div>
            </div>
        </main>
    </div>
    <script src="../script.js"></script>
    <script src="../auth.js"></script>
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>np-leonx | Admin</title>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Markazi+Text:wght@400;700&display=swap" rel="stylesheet">
        <!-- css -->
        <link rel="stylesheet" href="../global.module.css">
        <link rel="stylesheet" href="./editProject.css">
        <!-- icons -->
        <script src="https://kit.fontawesome.com/86a1656fba.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
            <div class="side-nav">
                <nav>
                    <div class="header-body-nav">
                        <div class="nav-header">
                            <h1>LeonX</h1>
                        </div>
                        <div class="nav-menu">
                            <a href="../Home.html">
                                <div class="each-menu">
                                    <div class="menu-icon"><i class="fa-brands fa-windows"></i></div>
                                    <span>Dashboard</span>
                                </div>
                            </a>
                            <a href="../Blogs.html">
                                <div class="each-menu">
                                    <div class="menu-icon"><i class="fa-regular fa-newspaper"></i></div>
                                    <span>Blogs</span>
                                </div>
                            </a>
                            <a href="../skills/Skills.html">
                                <div class="each-menu">
                                    <div class="menu-icon"><i class="fa-solid fa-code"></i></div>
                                    <span>Skills</span>
                                </div>
                            </a>
                            <a href="../projects/Projects.html">
                                <div class="each-menu">
                                    <div class="menu-icon"><i class="fa-brands fa-app-store-ios"></i></div>
                                    <span>Projects</span>
                                </div>
                            </a>
                            <a href="../services/services.html">
                                <div class="each-menu">
                                    <div class="menu-icon"><i class="fa-brands fa-servicestack"></i></div>
                                    <span>Services</span>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="nav-footer">
                        <div class="nav-footer-menu">
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-solid fa-gear"></i></div>
                                <span>Settings</span>
                            </div>
                            <div class="each-menu">
                                <div class="menu-icon"><i class="fa-solid fa-right-from-bracket"></i></div>
                                <span>Logout</span>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
            <main class="main">
                <div class="top-nav">
                    <div class="toggle-icon"><i class="fa-solid fa-bars"></i></div>
                    <div class="profile-pic">
                        <p class="profile-name">NL</p>
                    </div>
                </div>
                <div class="body">
                    <div class="body-hero-part">
                        <h1>Edit a Project</h1>
                        <div class="hero-nav">
                            <p class="menu">Home</p>
                            <i class="fa-solid fa-grip-lines-vertical"></i>
                            <p>Edit Project</p>
                        </div>
                    </div>
                    <div class="new-project-form">
                        <div class="project-header-menu">
                            <a href="./Projects.html">
                                <button>Projects List</button>
                            </a>
                        </div>
                        <form id="edit-project-form">
                            <div class="inputs">
                                <input type="text" id="edit-project-title" placeholder="Project title ...">
                                <select name="category" id="edit-project-category">
                                    <option value="">Select Category</option>
                                    <option value="Web">Web</option>
                                    <option value="Mobile">Mobile</option>
                                    <option value="Ui">UI/UX</option>
                                </select>
                            </div>
                            <div class="inputs">
                                <input type="text" id="edit-project-link" placeholder="Link ...">
                                <input type="date" id="project-finished-date">
                            </div>
                            <div class="inputs">
                                <input type="file" id="edit-project-image" required>
                            </div>
                            <div class="text-area">
                                <textarea id="edit-project-description" placeholder="Description ..." cols="30" rows="14"></textarea>
                            </div>
                            <button type="submit">Edit</button>
                        </form>
                    </div>
                </div>
                </div>
            </main>
        </div>
        <script src="../script.js"></script>
        <script src="../auth.js"></script>
        <script>
            const form = document.getElementById('edit-project-form');
            document.addEventListener('DOMContentLoaded', function() {
                const projects = JSON.parse(localStorage.getItem('Projects')) || [];
        
                // Function to extract project ID from URL
                function getProjectIdFromUrl() {
                    const queryParams = new URLSearchParams(window.location.search);
                    return parseInt(queryParams.get('id'));
                }
        
                // Function to retrieve project details from localStorage
                function getProjectDetails(projectId) {
                    return projects.find(project => project.projectId === projectId);
                }
        
                // Function to populate form fields with project details
                function populateFormFields(project) {
                    document.getElementById('edit-project-title').value = project.title;
                    document.getElementById('edit-project-category').value = project.category;
                    document.getElementById('edit-project-link').value = project.link;
                    document.getElementById('project-finished-date').value = project.finisheddate;
                    // document.getElementById('edit-project-image').value = project.image;
                    document.getElementById('edit-project-description').value = project.description;
                }
        
                // Get project ID from URL
                const projectId = getProjectIdFromUrl();
        
                // Retrieve project details from localStorage
                const project = getProjectDetails(projectId);
        
                // Populate form fields with project details
                populateFormFields(project);
        
                // Event listener for form submission (for editing project)
                form.addEventListener('submit', function(event) {
                    event.preventDefault();
        
                    // Retrieve updated values from form fields
                    const updatedProject = {
                        projectId: projectId, // Retain the original project ID
                        title: document.getElementById('edit-project-title').value,
                        category: document.getElementById('edit-project-category').value,
                        link: document.getElementById('edit-project-link').value,
                        // image: document.getElementById('edit-project-image').value, // Remove this line
                        description: document.getElementById('edit-project-description').value
                    };
        
                    // Read image as URL
                    const file = document.getElementById('edit-project-image').files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            updatedProject.image = e.target.result;
                            // Update project in the projects array
                            const index = projects.findIndex(project => project.projectId === projectId);
                            if (index !== -1) {
                                projects[index] = updatedProject;
                                localStorage.setItem('Projects', JSON.stringify(projects));
                                form.reset();
                                alert("Project updated successfully!");
                            }
                        };
                        reader.readAsDataURL(file);
                    } else {
                        // If no image is selected, update project without the image
                        const index = projects.findIndex(project => project.projectId === projectId);
                        if (index !== -1) {
                            projects[index] = updatedProject;
                            localStorage.setItem('Projects', JSON.stringify(projects));
                            form.reset();
                            alert("Project updated successfully!");
                        }
                    }
        
                    // After updating the project details, you can redirect the user or show a success message
                    console.log('Project updated:', updatedProject);
                });
            });
        </script>
        
    </body>
    </html>
</body>
</html>